{{!-- NPC Config - Factions Tab --}}
<div class="tab-content factions-tab {{theme}}" {{#unless (eq activeTab 'factions')}}hidden{{/unless}}>
  <section class="config-section">
    <h3>{{localize "BOBSNPC.NPCConfig.FactionMemberships"}}</h3>
    <p class="section-hint">{{localize "BOBSNPC.NPCConfig.FactionMembershipsHint"}}</p>

    {{#if factionsDisplay.length}}
      <ul class="factions-list">
        {{#each factionsDisplay}}
          <li class="faction-entry">
            <div class="faction-info">
              <i class="fa-solid {{this.icon}}" style="color: {{this.color}}"></i>
              <span class="faction-name">{{this.name}}</span>
            </div>

            <div class="faction-details">
              <div class="form-group inline">
                <label>{{localize "BOBSNPC.NPCConfig.Role"}}</label>
                <select name="config.factions.{{this.index}}.role">
                  <option value="member" {{#if (eq this.role 'member')}}selected{{/if}}>
                    {{localize "BOBSNPC.NPCConfig.FactionRole.Member"}}
                  </option>
                  <option value="officer" {{#if (eq this.role 'officer')}}selected{{/if}}>
                    {{localize "BOBSNPC.NPCConfig.FactionRole.Officer"}}
                  </option>
                  <option value="leader" {{#if (eq this.role 'leader')}}selected{{/if}}>
                    {{localize "BOBSNPC.NPCConfig.FactionRole.Leader"}}
                  </option>
                  <option value="ally" {{#if (eq this.role 'ally')}}selected{{/if}}>
                    {{localize "BOBSNPC.NPCConfig.FactionRole.Ally"}}
                  </option>
                </select>
              </div>

              <div class="form-group inline">
                <label>{{localize "BOBSNPC.NPCConfig.Rank"}}</label>
                <input type="text" name="config.factions.{{this.index}}.rank"
                       value="{{this.rank}}" placeholder="{{localize 'BOBSNPC.NPCConfig.RankPlaceholder'}}" />
              </div>
            </div>

            <button type="button" class="remove-btn" data-action="removeFaction" data-index="{{this.index}}">
              <i class="fa-solid fa-times"></i>
            </button>
          </li>
        {{/each}}
      </ul>
    {{else}}
      <div class="empty-state">
        <i class="fa-solid fa-flag"></i>
        <p>{{localize "BOBSNPC.NPCConfig.NoFactions"}}</p>
      </div>
    {{/if}}
  </section>

  <section class="config-section">
    <h3>{{localize "BOBSNPC.NPCConfig.AddFaction"}}</h3>

    <div class="add-faction-form">
      <select name="newFaction">
        <option value="">{{localize "BOBSNPC.NPCConfig.SelectFaction"}}</option>
        {{#each availableFactions}}
          <option value="{{this.id}}">{{this.name}}</option>
        {{/each}}
      </select>
      <button type="button" class="add-btn" data-action="addFaction">
        <i class="fa-solid fa-plus"></i>
        {{localize "BOBSNPC.NPCConfig.Add"}}
      </button>
    </div>
  </section>
</div>
